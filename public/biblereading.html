<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible Reading - Electronic Bible Fellowship</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --background-color: #f8f9fa;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 0;
        }

        .header {
            background: linear-gradient(135deg, #3498db, #2c3e50);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            margin: 0.5rem 0;
            font-size: 1.8rem;
        }

        .header p {
            margin: 0;
            opacity: 0.9;
        }

        .nav {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 0.8rem 1.5rem;
            border-radius: 2rem;
            background: var(--secondary-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .nav-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .current-chapter {
            background: #e74c3c !important;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .player-box {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .chapter-box {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .chapter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .chapter-item {
            padding: 1.2rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .chapter-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .book-name {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .chapter-number {
            font-size: 1.2em;
            font-weight: 500;
            margin-top: 0.5rem;
        }

        .current-playing {
            background: linear-gradient(135deg, #3498db, #2c3e50);
            color: white !important;
        }

        .current-playing .book-name {
            color: rgba(255,255,255,0.8) !important;
        }

        .download-hint {
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-top: 1rem;
            text-align: center;
        }

        .aplayer {
            margin: 1rem 0;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Book selection modal */
        .book-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .book-selector {
            background: white;
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 1rem;
            max-height: 80vh;
            overflow-y: auto;
        }

        .book-item {
            padding: 0.8rem;
            margin: 0.5rem 0;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s ease;
        }

        .book-item:hover {
            background: #f8f9fa;
        }

        @media (max-width: 768px) {
            .chapter-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .nav-button {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>ğŸ“– åœ£ç»é˜…è¯»ç³»ç»Ÿ</h1>
        <p>ç”µå­åœ£ç»å›¢å¥‘ - è†å¬ä¸Šå¸çš„è¯è¯­</p>
    </header>
    
    <nav class="nav">
        <button class="nav-button" onclick="history.back()">
            <i class="fas fa-home"></i> é¦–é¡µ
        </button>
        <button class="nav-button" onclick="showBookSelector()">
            <i class="fas fa-book"></i> é€‰æ‹©ä¹¦å·
        </button>
        <span class="nav-button current-chapter">
            <i class="fas fa-play-circle"></i> 
            <span id="currentChapter">åˆ›ä¸–è®° ç¬¬1ç« </span>
        </span>
        <a href="bible_text.html" target="_blank" class="nav-button">
            <i class="fas fa-bible"></i> åœ£ç»æ–‡æœ¬
        </a>
    </nav>
    
    <div class="container">
        <div class="player-box">
            <h2>å½“å‰æ’­æ”¾</h2>
            <div id="aplayer"></div>
        </div>
    
        <div class="chapter-box">
            <div class="download-hint">
                å³é”®ç‚¹å‡»ç« èŠ‚ â†’ å¦å­˜ä¸ºé“¾æ¥ä¸‹è½½éŸ³é¢‘
            </div>
            <div class="chapter-grid" id="chapterGrid"></div>
        </div>
    </div>

    <!-- Book selection modal -->
    <div class="book-modal" id="bookModal">
        <div class="book-selector">
            <h3>Please select a Bible book</h3>
            <div id="bookList"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
    <script>
        // Complete Bible books database in English (66 books)
       // å®Œæ•´çš„åœ£ç»ä¹¦å·æ•°æ®åº“ï¼ˆåŒ…å« 66 å·ï¼‰
const bibleBooks = [
    { id: 1, name: "Genesis", chineseName: "åˆ›ä¸–è®°", chapters: 50 },
    { id: 2, name: "Exodus", chineseName: "å‡ºåŸƒåŠè®°", chapters: 40 },
    { id: 3, name: "Leviticus", chineseName: "åˆ©æœªè®°", chapters: 27 },
    { id: 4, name: "Numbers", chineseName: "æ°‘æ•°è®°", chapters: 36 },
    { id: 5, name: "Deuteronomy", chineseName: "ç”³å‘½è®°", chapters: 34 },
    { id: 6, name: "Joshua", chineseName: "çº¦ä¹¦äºšè®°", chapters: 24 },
    { id: 7, name: "Judges", chineseName: "å£«å¸ˆè®°", chapters: 21 },
    { id: 8, name: "Ruth", chineseName: "è·¯å¾—è®°", chapters: 4 },
    { id: 9, name: "1 Samuel", chineseName: "æ’’æ¯è€³è®°ä¸Š", chapters: 31 },
    { id: 10, name: "2 Samuel", chineseName: "æ’’æ¯è€³è®°ä¸‹", chapters: 24 },
    { id: 11, name: "1 Kings", chineseName: "åˆ—ç‹è®°ä¸Š", chapters: 22 },
    { id: 12, name: "2 Kings", chineseName: "åˆ—ç‹è®°ä¸‹", chapters: 25 },
    { id: 13, name: "1 Chronicles", chineseName: "å†ä»£å¿—ä¸Š", chapters: 29 },
    { id: 14, name: "2 Chronicles", chineseName: "å†ä»£å¿—ä¸‹", chapters: 36 },
    { id: 15, name: "Ezra", chineseName: "ä»¥æ–¯æ‹‰è®°", chapters: 10 },
    { id: 16, name: "Nehemiah", chineseName: "å°¼å¸Œç±³è®°", chapters: 13 },
    { id: 17, name: "Esther", chineseName: "ä»¥æ–¯å¸–è®°", chapters: 10 },
    { id: 18, name: "Job", chineseName: "çº¦ä¼¯è®°", chapters: 42 },
    { id: 19, name: "Psalms", chineseName: "è¯—ç¯‡", chapters: 150 },
    { id: 20, name: "Proverbs", chineseName: "ç®´è¨€", chapters: 31 },
    { id: 21, name: "Ecclesiastes", chineseName: "ä¼ é“ä¹¦", chapters: 12 },
    { id: 22, name: "Song of Solomon", chineseName: "é›…æ­Œ", chapters: 8 },
    { id: 23, name: "Isaiah", chineseName: "ä»¥èµ›äºšä¹¦", chapters: 66 },
    { id: 24, name: "Jeremiah", chineseName: "è€¶åˆ©ç±³ä¹¦", chapters: 52 },
    { id: 25, name: "Lamentations", chineseName: "è€¶åˆ©ç±³å“€æ­Œ", chapters: 5 },
    { id: 26, name: "Ezekiel", chineseName: "ä»¥è¥¿ç»“ä¹¦", chapters: 48 },
    { id: 27, name: "Daniel", chineseName: "ä½†ä»¥ç†ä¹¦", chapters: 12 },
    { id: 28, name: "Hosea", chineseName: "ä½•è¥¿é˜¿ä¹¦", chapters: 14 },
    { id: 29, name: "Joel", chineseName: "çº¦ç¥ä¹¦", chapters: 3 },
    { id: 30, name: "Amos", chineseName: "é˜¿æ‘©å¸ä¹¦", chapters: 9 },
    { id: 31, name: "Obadiah", chineseName: "ä¿„å·´åº•äºšä¹¦", chapters: 1 },
    { id: 32, name: "Jonah", chineseName: "çº¦æ‹¿ä¹¦", chapters: 4 },
    { id: 33, name: "Micah", chineseName: "å¼¥è¿¦ä¹¦", chapters: 7 },
    { id: 34, name: "Nahum", chineseName: "é‚£é¸¿ä¹¦", chapters: 3 },
    { id: 35, name: "Habakkuk", chineseName: "å“ˆå·´è°·ä¹¦", chapters: 3 },
    { id: 36, name: "Zephaniah", chineseName: "è¥¿ç•ªé›…ä¹¦", chapters: 3 },
    { id: 37, name: "Haggai", chineseName: "å“ˆè¯¥ä¹¦", chapters: 2 },
    { id: 38, name: "Zechariah", chineseName: "æ’’è¿¦åˆ©äºšä¹¦", chapters: 14 },
    { id: 39, name: "Malachi", chineseName: "ç›æ‹‰åŸºä¹¦", chapters: 4 },
    { id: 40, name: "Matthew", chineseName: "é©¬å¤ªç¦éŸ³", chapters: 28 },
    { id: 41, name: "Mark", chineseName: "é©¬å¯ç¦éŸ³", chapters: 16 },
    { id: 42, name: "Luke", chineseName: "è·¯åŠ ç¦éŸ³", chapters: 24 },
    { id: 43, name: "John", chineseName: "çº¦ç¿°ç¦éŸ³", chapters: 21 },
    { id: 44, name: "Acts", chineseName: "ä½¿å¾’è¡Œä¼ ", chapters: 28 },
    { id: 45, name: "Romans", chineseName: "ç½—é©¬ä¹¦", chapters: 16 },
    { id: 46, name: "1 Corinthians", chineseName: "å“¥æ—å¤šå‰ä¹¦", chapters: 16 },
    { id: 47, name: "2 Corinthians", chineseName: "å“¥æ—å¤šåä¹¦", chapters: 13 },
    { id: 48, name: "Galatians", chineseName: "åŠ æ‹‰å¤ªä¹¦", chapters: 6 },
    { id: 49, name: "Ephesians", chineseName: "ä»¥å¼—æ‰€ä¹¦", chapters: 6 },
    { id: 50, name: "Philippians", chineseName: "è…“ç«‹æ¯”ä¹¦", chapters: 4 },
    { id: 51, name: "Colossians", chineseName: "æ­Œç½—è¥¿ä¹¦", chapters: 4 },
    { id: 52, name: "1 Thessalonians", chineseName: "å¸–æ’’ç½—å°¼è¿¦å‰ä¹¦", chapters: 5 },
    { id: 53, name: "2 Thessalonians", chineseName: "å¸–æ’’ç½—å°¼è¿¦åä¹¦", chapters: 3 },
    { id: 54, name: "1 Timothy", chineseName: "ææ‘©å¤ªå‰ä¹¦", chapters: 6 },
    { id: 55, name: "2 Timothy", chineseName: "ææ‘©å¤ªåä¹¦", chapters: 4 },
    { id: 56, name: "Titus", chineseName: "æå¤šä¹¦", chapters: 3 },
    { id: 57, name: "Philemon", chineseName: "è…“åˆ©é—¨ä¹¦", chapters: 1 },
    { id: 58, name: "Hebrews", chineseName: "å¸Œä¼¯æ¥ä¹¦", chapters: 13 },
    { id: 59, name: "James", chineseName: "é›…å„ä¹¦", chapters: 5 },
    { id: 60, name: "1 Peter", chineseName: "å½¼å¾—å‰ä¹¦", chapters: 5 },
    { id: 61, name: "2 Peter", chineseName: "å½¼å¾—åä¹¦", chapters: 3 },
    { id: 62, name: "1 John", chineseName: "çº¦ç¿°ä¸€ä¹¦", chapters: 5 },
    { id: 63, name: "2 John", chineseName: "çº¦ç¿°äºŒä¹¦", chapters: 1 },
    { id: 64, name: "3 John", chineseName: "çº¦ç¿°ä¸‰ä¹¦", chapters: 1 },
    { id: 65, name: "Jude", chineseName: "çŠ¹å¤§ä¹¦", chapters: 1 },
    { id: 66, name: "Revelation", chineseName: "å¯ç¤ºå½•", chapters: 22 }
];

let currentBook = 1;
        let currentChapter = 1;
        const chapterGrid = document.getElementById('chapterGrid');
        const currentChapterSpan = document.getElementById('currentChapter');
        const bookModal = document.getElementById('bookModal');
        const bookList = document.getElementById('bookList');

        // ä» URL å‚æ•°è·å– bookï¼Œæ”¯æŒåˆ«å
        const urlParams = new URLSearchParams(window.location.search);
        let bookParam = urlParams.get('book');
        if (bookParam) {
            let normalizedParam = bookParam.toLowerCase().replace(/\s+/g, '');
            const aliasMapping = {
                "exdos": "exodus"
            };
            if (aliasMapping[normalizedParam]) {
                normalizedParam = aliasMapping[normalizedParam];
            }
            for (let i = 0; i < bibleBooks.length; i++) {
                const normalizedBookName = bibleBooks[i].name.toLowerCase().replace(/\s+/g, '');
                if (normalizedBookName === normalizedParam) {
                    currentBook = bibleBooks[i].id;
                    break;
                }
            }
        }

        // åˆå§‹åŒ– APlayer
        const ap = new APlayer({
            container: document.getElementById('aplayer'),
            audio: [],
            mutex: true,
            preload: 'auto',
            theme: '#3498db'
        });

        // ç”Ÿæˆä¹¦å·é€‰æ‹©åˆ—è¡¨
        function initBookSelector() {
            bibleBooks.forEach(book => {
                const div = document.createElement('div');
                div.className = 'book-item';
                // æ˜¾ç¤ºä¸­æ–‡ä¹¦å
                div.textContent = book.chineseName;
                div.onclick = () => {
                    currentBook = book.id;
                    currentChapter = 1;
                    generateChapters(book.id);
                    currentChapterSpan.textContent = `${book.chineseName} ç¬¬${currentChapter}ç« `;
                    bookModal.style.display = 'none';
                };
                bookList.appendChild(div);
            });
        }

        // æ˜¾ç¤ºä¹¦å·é€‰æ‹©å¼¹çª—
        function showBookSelector() {
            bookModal.style.display = 'block';
            // ç‚¹å‡»ç©ºç™½å¤„å…³é—­å¼¹çª—
            window.onclick = (e) => {
                if (e.target === bookModal) {
                    bookModal.style.display = 'none';
                }
            }
        }

        // ç”Ÿæˆç« èŠ‚æŒ‰é’®
        function generateChapters(bookId) {
            chapterGrid.innerHTML = '';
            const book = bibleBooks.find(b => b.id === bookId);
            
            for (let i = 1; i <= book.chapters; i++) {
                const button = document.createElement('div');
                button.className = `chapter-item ${currentChapter === i && currentBook === bookId ? 'current-playing' : ''}`;
                button.innerHTML = `
                    <div class="book-name">${book.chineseName}</div>
                    <div class="chapter-number">ç¬¬ ${i} ç« </div>
                `;
                
                // å·¦é”®ç‚¹å‡»æ’­æ”¾ç« èŠ‚
                button.onclick = () => playChapter(bookId, i);

                // å³é”®ç‚¹å‡»ä¸‹è½½éŸ³é¢‘
                button.oncontextmenu = (e) => {
                    e.preventDefault();
                    const url = `https://www.wordproaudio.net/bibles/app/audio/4/${bookId}/${i}.mp3`;
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `${book.chineseName} ç¬¬${i}ç« .mp3`;
                    link.click();
                };
                chapterGrid.appendChild(button);
            }
        }

        // æ’­æ”¾æŒ‡å®šç« èŠ‚
        function playChapter(bookId, chapter) {
            currentBook = bookId;
            currentChapter = chapter;
            const book = bibleBooks.find(b => b.id === bookId);
            
            ap.list.clear();
            ap.list.add([{
                name: `${book.chineseName} ç¬¬ ${chapter} ç« `,
                artist: 'åœ£ç»é˜…è¯»',
                url: `https://www.wordproaudio.net/bibles/app/audio/4/${bookId}/${chapter}.mp3`,
                cover: 'cover.jpg'
            }]);
            
            currentChapterSpan.textContent = `${book.chineseName} ç¬¬${chapter}ç« `;
            ap.play();
            generateChapters(currentBook); // åˆ·æ–°ç« èŠ‚åˆ—è¡¨é€‰ä¸­çŠ¶æ€
        }

        // è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€ç« 
        ap.on('ended', () => {
            const book = bibleBooks.find(b => b.id === currentBook);
            if (currentChapter < book.chapters) {
                playChapter(currentBook, currentChapter + 1);
            } else if (currentBook < 66) {
                // è‹¥å½“å‰ä¹¦å·æ’­æ”¾å®Œï¼Œåˆ™è‡ªåŠ¨è·³è½¬åˆ°ä¸‹ä¸€å·çš„ç¬¬1ç« 
                playChapter(currentBook + 1, 1);
            }
        });

        // åˆå§‹åŒ–
        initBookSelector();
        generateChapters(currentBook);
    </script>
</body>
</html>